---
name: merge-all
description: 合并所有节点文档为完整综合文档。读取node-list.txt，查找并合并所有节点markdown文件，进行润色、调整和优化，生成一篇完整、详细、准确、统一的综合文档。适用于将多个独立章节整合为最终成品的场景。
---

# Merge All

## Overview

将所有节点文档合并为一篇完整的综合文档。处理节点间的衔接、整体结构优化、格式统一、内容润色，最终生成可直接发布的完整文档。

## Workflow

### 1. 读取节点列表

从`node-list.txt`读取所有节点名称，确定合并顺序。

### 2. 收集节点文档

使用Glob工具查找所有节点markdown文件：
- 按node-list.txt顺序匹配
- 验证每个节点文档是否存在
- 报告缺失的节点文档

### 3. 合并策略

**文档结构**：
```markdown
# {文档主标题}

## 文档信息
- 作者：{作者名}
- 创建时间：{日期}
- 最后更新：{日期}
- 字数统计：{总字数}

## 目录
{自动生成的完整目录}

--- 正文开始 ---

{节点1内容}

---

{节点2内容}

---

{节点3内容}

--- 正文结束 ---

## 附录
- 完整参考资料列表
- 术语表
- 相关资源
```

### 4. 内容润色与优化

**节点间衔接**：
- 添加过渡段落
- 保持逻辑连贯性
- 消除重复内容

**格式统一**：
- 标题层级调整（避免#冲突）
- 代码块语言标识统一
- 表格格式一致
- 图片引用格式统一

**内容优化**：
- 删除重复的开头/结尾
- 统一术语表达
- 调整段落长度
- 优化句子结构

### 5. 输出格式

生成最终文档：`{主标题}.md`
- 编码：UTF-8
- 格式：标准Markdown
- 包含完整元数据

## Scripts

### `scripts/merge_documents.py`

自动合并多个markdown文件。

**功能**：
- 按顺序读取节点文档
- 自动添加分隔符
- 生成目录
- 统计字数

### `scripts/validate_merged.py`

验证合并后的文档质量。

**检查项**：
- 所有节点是否包含
- 标题层级是否正确
- 链接引用是否有效
- 格式是否统一

## Examples

### 示例：完整合并

**输入** (`node-list.txt`)：
```
Docker简介
Docker安装配置
Docker基本命令
Docker实战
```

**节点文档**：
- `Docker简介.md`
- `Docker安装配置.md`
- `Docker基本命令.md`
- `Docker实战.md`

**输出** (`Docker完整指南.md`)：
```markdown
# Docker完整指南

## 文档信息
- 创建时间：2026-02-10
- 最后更新：2026-02-10
- 字数统计：约8500字

## 目录

- [1. Docker简介](#1-docker简介)
  - [1.1 什么是Docker](#11-什么是docker)
  - [1.2 Docker与传统虚拟化](#12-docker与传统虚拟化)
  - [1.3 Docker的应用场景](#13-docker的应用场景)
- [2. Docker安装配置](#2-docker安装配置)
  - [2.1 Linux安装](#21-linux安装)
  - [2.2 macOS安装](#22-macos安装)
  - [2.3 Windows安装](#23-windows安装)
  - [2.4 配置国内镜像源](#24-配置国内镜像源)
- [3. Docker基本命令](#3-docker基本命令)
  - [3.1 镜像操作](#31-镜像操作)
  - [3.2 容器操作](#32-容器操作)
- [4. Docker实战](#4-docker实战)
  - [4.1 部署Web应用](#41-部署web应用)
  - [4.2 编写Dockerfile](#42-编写dockerfile)

---

# 1. Docker简介

## 概述

Docker是一个开源的应用容器引擎，让开发者可以打包他们的应用以及依赖包到一个可移植的容器中，然后发布到任何流行的Linux机器上。

...

---

# 2. Docker安装配置

## 概述

在前一章了解了Docker的基本概念后，本章将介绍如何在各种操作系统上安装和配置Docker环境。

...

（中间章节）

---

# 4. Docker实战

## 概述

通过前面章节的学习，我们已经掌握了Docker的基本概念和操作命令。本章将通过实际案例，演示如何使用Docker部署真实的应用。

...

---

## 附录

### 完整参考资料

1. [Docker官方文档](https://docs.docker.com/)
2. [Docker Hub](https://hub.docker.com/)
3. [Dockerfile最佳实践](https://docs.docker.com/develop/dev-best-practices/)

### 术语表

| 术语 | 定义 |
|------|------|
| 镜像（Image） | 只读模板，包含运行应用所需的代码、库、依赖 |
| 容器（Container） | 镜像的运行实例，相互隔离 |
| 仓库（Registry） | 存储和分发镜像的服务 |

### 相关资源

- [Docker官方培训](https://www.docker.com/training)
- [Docker中文社区](https://www.docker.org.cn/)
```

## Troubleshooting

| 问题 | 解决方案 |
|------|----------|
| 节点文档缺失 | 报告缺失节点，暂停合并等待处理 |
| 标题层级冲突 | 调整子节点标题级别，保持层次清晰 |
| 内容重复 | 删除重复部分，保留最完整的版本 |
| 衔接不自然 | 添加过渡段落，使用承上启下的语句 |
| 格式不一致 | 统一代码块、表格、图片的格式 |

## Quality Checklist

合并完成后的检查清单：

### 结构完整性
- [ ] 所有节点都已包含
- [ ] 目录与章节对应
- [ ] 页面内链接有效
- [ ] 标题层级正确

### 内容质量
- [ ] 逻辑连贯性良好
- [ ] 无内容重复
- [ ] 过渡自然流畅
- [ ] 术语表达统一

### 格式规范
- [ ] Markdown语法正确
- [ ] 代码块语言标识
- [ ] 图片链接有效
- [ ] 表格格式统一

### 元数据
- [ ] 文档标题正确
- [ ] 创建时间记录
- [ ] 字数统计准确
- [ ] 参考资料完整

## Advanced Features

### 自动生成目录

使用脚本自动从标题生成目录：

```python
# 伪代码示例
for header in headers:
    level = header.level
    text = header.text
    anchor = generate_anchor(text)
    indent = "  " * (level - 1)
    catalog += f"{indent}- [{text}](#{anchor})\n"
```

### 交叉引用处理

处理文档内部的交叉引用：
- 章节引用：`[相关内容](#章节标题)`
- 图片引用：`![描述](path/to/image.png)`
- 代码引用：`\`代码片段\``

### 术语统一

维护术语表，确保全文术语一致：
- 创建术语映射字典
- 替换不一致的表达
- 保留专业术语的原文
